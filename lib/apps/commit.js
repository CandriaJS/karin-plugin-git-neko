import {e,c}from'../chunk-UBICTORI.js';import {d,b as b$1}from'../chunk-SWUTSNE3.js';import {get_relative_time}from'git-neko-kit';import w from'markdown-it';import b,{logger}from'node-karin';var k=b.command(/^#?(?:(?:清语)?Git插件|git-neko-plugin)?(?:GitHub)(?:最新)?(?:提交|commit)(?:信息|info)\s*([\w-]+)[\/\s]+([\w-]+)(?:\s+([\w-]+))?/i,async i=>{try{let a=i.msg.match(k.reg),[,o,m,e$1]=a,d$1=await e.get_user_token(i.userId),r=c.get_github(d$1),_=await r.get_commit(),l=await r.get_repo(),t=await _.get_commit_info({owner:o,repo:m,sha:e$1,format:!0}),h=await l.get_repo_visibility({owner:o,repo:m}),p=new w({html:!0}).render(t.data.commit.body),f=await d.render("commit/get_commit_info",{platform:"github",title:"\u63D0\u4EA4\u4FE1\u606F",commits:[{owner:o,repo:m,branch:e$1??"main",sha:t.data.sha.slice(0,7),visibility:h,author_avatar:t.data?.author?.avatar_url,author_name:t.data?.author?.login,commit_date:await get_relative_time(t.data?.commit?.committer?.date),commit_title:t.data.commit.title,commit_body:p,commit_additions:t.data?.stats?.additions,commit_deletions:t.data?.stats?.deletions,commit_files_total:t.data?.files?.length}]});await i.reply(f);}catch(a){logger.error(a),await i.reply(`[${b$1.Plugin_AliasName}]: ${a.message}`);}},{name:"\u6E05\u8BEDGit\u63D2\u4EF6:\u63D0\u4EA4\u4FE1\u606F",priority:-1/0,event:"message",permission:"all"});export{k as get_commit_info};